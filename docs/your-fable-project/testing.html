<html class="has-navbar-fixed-top" lang="en"><head><title>Fable · Testing</title><meta http-equiv="content-type" content="text/html; charset=UTF-8" charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" type="text/css" href="/style.css"/><script src="https://unpkg.com/scroll-into-view-if-needed@2.2.28/umd/scroll-into-view-if-needed.min.js"></script></head><body><nav class="navbar is-fixed-top is-spaced"><div class="container"><div class="navbar-brand"><a class="navbar-item title is-4" href="https://fable.io/">Fable</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/docs">Documentation</a><a class="navbar-item is-hidden-mobile" href="/repl/">Try</a><a class="navbar-item" href="/blog/index.html">Blog</a><a class="navbar-item is-hidden-mobile" href="/community.html">Community</a><a class="navbar-item is-hidden-mobile" href="/resources.html">Resources</a><div class="navbar-item navbar-burger-dots is-hidden-tablet"><svg height="4" stroke="none" viewBox="0 0 22 4" width="22"><circle cx="2" cy="2" r="2"></circle><circle cx="2" cy="2" r="2" transform="translate(9,0)"></circle><circle cx="2" cy="2" r="2" transform="translate(18,0)"></circle></svg></div></div><div class="navbar-end is-hidden-mobile"><a class="navbar-item" href="https://github.com/fable-compiler/fable"><span class="icon"><i class=" fab fa-github fa-lg"></i></span></a><a class="navbar-item" href="https://twitter.com/FableCompiler"><span class="icon"><i class=" fab fa-twitter fa-lg"></i></span></a><a class="navbar-item" href="https://gitter.im/fable-compiler/Fable"><span class="icon"><i class=" fab fa-gitter fa-lg"></i></span></a><a class="navbar-item" href="https://www.youtube.com/channel/UC6m70Jyr65ogDySbK7aMmzg/videos"><span class="icon"><i class=" fab fa-youtube fa-lg"></i></span></a></div></div><div class="nacara-navbar-menu"><a class="nacara-navbar-menu-item" href="/repl/">Try</a><a class="nacara-navbar-menu-item" href="/community.html">Community</a><a class="nacara-navbar-menu-item" href="/resources.html">Resources</a><a class="nacara-navbar-menu-item" href="https://github.com/fable-compiler/fable">Github</a><a class="nacara-navbar-menu-item" href="https://twitter.com/FableCompiler">Twitter</a><a class="nacara-navbar-menu-item" href="https://gitter.im/fable-compiler/Fable">Gitter</a><a class="nacara-navbar-menu-item" href="https://www.youtube.com/channel/UC6m70Jyr65ogDySbK7aMmzg/videos">Youtube</a></div></div></nav><div class="grey-overlay"></div><div class="nacara-content"><div class="container"><div class="mobile-menu"><nav class="breadcrumb"><ul><li><a class="menu-trigger"><span></span><span></span><span></span></a></li><li class="is-active"><a>Documentation</a></li><li class="is-active"><a>Your Fable project</a></li><li class="is-active"><a>Testing</a></li></ul></nav></div><div class="columns is-gapless is-mobile"><div class="column is-menu-column is-3-desktop is-hidden-touch"><div class="menu-container"><aside class="menu"><p class="menu-label">Introduction</p><ul class="menu-list"><li><a class=" " href="/docs/index.html">What is Fable?</a></li><li><a class=" " href="/docs/introduction/dotnet-users-read-this.html">Are you a .NET developer?</a></li><li><a class=" " href="/docs/introduction/js-users-read-this.html">Are you a JS developer?</a></li></ul><p class="menu-label">New to F#?</p><ul class="menu-list"><li><a class=" " href="/docs/new-to-fsharp/learning-the-language.html">Learning the language</a></li><li><a class=" " href="/docs/new-to-fsharp/let-keyword.html">The let keyword</a></li></ul><p class="menu-label">Fable in 2 steps</p><ul class="menu-list"><li><a class=" " href="/docs/2-steps/setup.html">Setup</a></li><li><a class=" " href="/docs/2-steps/your-first-fable-project.html">Start a new project</a></li></ul><p class="menu-label">Your Fable project</p><ul class="menu-list"><li><a class=" " href="/docs/your-fable-project/project-file.html">The project file</a></li><li><a class=" " href="/docs/your-fable-project/use-a-fable-library.html">Use a Fable library</a></li><li><a class=" " href="/docs/your-fable-project/author-a-fable-library.html">Author a Fable library</a></li><li><a class=" " href="/docs/your-fable-project/build-and-run.html">Build &amp; run</a></li><li><a class=" is-active" href="/docs/your-fable-project/testing.html">Testing</a></li><li><ul class="table-of-content"><li data-toc-rank="2"><a href="#setup" data-toc-element="true">Setup</a></li><li data-toc-rank="2"><a href="#write-tests" data-toc-element="true">Write tests</a></li><li data-toc-rank="2"><a href="#run" data-toc-element="true">Run</a></li><li data-toc-rank="2"><a href="#watch-mode" data-toc-element="true">Watch mode</a></li></ul></li></ul><p class="menu-label">Communicate with Javascript</p><ul class="menu-list"><li><a class=" " href="/docs/communicate/js-from-fable.html">Call JS from Fable</a></li><li><a class=" " href="/docs/communicate/fable-from-js.html">Call Fable from JavaScript</a></li></ul><p class="menu-label">From .NET to Fable</p><ul class="menu-list"><li><a class=" " href="/docs/dotnet/compatibility.html">.NET and F# compatibility</a></li><li><a class=" " href="/docs/dotnet/numbers.html">Numeric types</a></li></ul><p class="menu-label">Miscellaneous</p><ul class="menu-list"><li><a class=" " href="/docs/miscellaneous/official-samples.html">Check official samples</a></li><li><a class=" " href="/docs/miscellaneous/fable-in-videos.html">Fable in videos</a></li></ul></aside></div></div><div class="column is-9-desktop is-full-touch"><section class="section"><div class="content"><header class="page-header"><div class="columns is-vcentered"><div class="column"><nav class="breadcrumb is-category-navigation is-hidden-touch"><ul><li class="is-active"><a>Documentation</a></li><li class="is-active"><a>Your Fable project</a></li><li class="is-active"><a>Testing</a></li></ul></nav></div><div class="column is-narrow"><a class="button is-hidden-touch is-ghost" target="_blank" href="https://github.com/fable-compiler/fable-compiler.github.io/edit/dev/docs/docs/your-fable-project/testing.md">Edit</a></div></div><h1 class="title is-1">Testing</h1></header><div><style class=grvsc-styles>.grvsc-container{overflow:auto;position:relative;-webkit-overflow-scrolling:touch;padding-top:1rem;padding-top:var(--grvsc-padding-top,var(--grvsc-padding-v,1rem));padding-bottom:1rem;padding-bottom:var(--grvsc-padding-bottom,var(--grvsc-padding-v,1rem));border-radius:8px;border-radius:var(--grvsc-border-radius,8px);font-feature-settings:normal;line-height:1.4}.grvsc-code{display:table}.grvsc-line{display:table-row;box-sizing:border-box;width:100%;position:relative}.grvsc-line>*{position:relative}.grvsc-gutter-pad{display:table-cell;padding-left:.75rem;padding-left:calc(var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem))/ 2)}.grvsc-gutter{display:table-cell;-webkit-user-select:none;-moz-user-select:none;user-select:none}.grvsc-gutter::before{content:attr(data-content)}.grvsc-source{display:table-cell;padding-left:1.5rem;padding-left:var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem));padding-right:1.5rem;padding-right:var(--grvsc-padding-right,var(--grvsc-padding-h,1.5rem))}.grvsc-source:empty::after{content:' ';-webkit-user-select:none;-moz-user-select:none;user-select:none}.grvsc-gutter+.grvsc-source{padding-left:.75rem;padding-left:calc(var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem))/ 2)}.grvsc-has-line-highlighting>.grvsc-code>.grvsc-line::before{content:' ';position:absolute;width:100%}.grvsc-line-diff-add::before{background-color:var(--grvsc-line-diff-add-background-color,rgba(0,255,60,.2))}.grvsc-line-diff-del::before{background-color:var(--grvsc-line-diff-del-background-color,rgba(255,0,20,.2))}.grvsc-line-number{padding:0 2px;text-align:right;opacity:.7}.atom-one-light{background-color:#fafafa;color:#383a42}.atom-one-light .mtki{font-style:italic}.atom-one-light .mtk1{color:#383a42}.atom-one-light .mtk7{color:#a0a1a7}.atom-one-light .mtk14{color:#a626a4}.atom-one-light .mtk9{color:#4078f2}.atom-one-light .mtk10{color:#50a14f}.atom-one-light .mtk6{color:#986801}.atom-one-light .mtk5{color:#e45649}.atom-one-light .mtk8{color:#0184bc}.atom-one-light .grvsc-line-highlighted::before{background-color:var(--grvsc-line-highlighted-background-color,rgba(0,0,0,.05));box-shadow:inset var(--grvsc-line-highlighted-border-width,4px) 0 0 0 var(--grvsc-line-highlighted-border-color,rgba(0,0,0,.2))}</style><p>You can use all tools of the JS ecosystem.<p>Several js libs already have a Fable binding:<ul><li>mocha: <a href=https://github.com/Zaid-Ajaj/Fable.Mocha>https://github.com/Zaid-Ajaj/Fable.Mocha</a><li>jest: <a href=https://github.com/Shmew/Fable.Jester>https://github.com/Shmew/Fable.Jester</a></ul><h1 id=example-with-jest>Example with jest<a href=#example-with-jest aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h1><h2 id=setup>Setup<a href=#setup aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>You should install js test runner :<pre class="atom-one-light grvsc-container"data-index=0 data-language=sh><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>  npm install jest --save-dev</span></span></span></code></pre><p>And Fable binding :<pre class="atom-one-light grvsc-container"data-index=1 data-language=sh><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class="mtk7 mtki"># nuget</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  dotnet add package Fable.Jester</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class="mtk7 mtki"># paket</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  paket add Fable.Jester --project ./project/path</span></span></span></code></pre><h2 id=write-tests>Write tests<a href=#write-tests aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>Now, you can write your first test :<pre class="atom-one-light grvsc-container"data-index=2 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Jester</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>Jest.describe</span><span class=mtk14>(</span><span class=mtk10>"can run basic tests"</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk14>fun</span><span class=mtk1> </span><span class=mtk14>()</span><span class=mtk1> </span><span class=mtk14>-></span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    Jest.test</span><span class=mtk14>(</span><span class=mtk10>"running a test"</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk14>fun</span><span class=mtk1> </span><span class=mtk14>()</span><span class=mtk1> </span><span class=mtk14>-></span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        Jest.expect</span><span class=mtk14>(</span><span class=mtk6>1</span><span class=mtk14>+</span><span class=mtk6>1</span><span class=mtk14>)</span><span class=mtk1>.toEqual</span><span class=mtk14>(</span><span class=mtk6>2</span><span class=mtk14>)</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>)</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>)</span></span></span></code></pre><p>See Jester documentation to more informations : <a href=https://shmew.github.io/Fable.Jester/>https://shmew.github.io/Fable.Jester/</a><h2 id=run>Run<a href=#run aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>Before running the tests, you have to convert your project to JS, but you don't need to bundle with Webpack, because test runners generally prefer to have small files rather than a single big file. So we only need to run the Fable compiler and put the generated code in an output dir.<pre class="atom-one-light grvsc-container"data-index=3 data-language=sh><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>  dotnet fable src -o output</span></span></span></code></pre><p>You should config Jest with a config file <code>jest.config.js</code> :<pre class="atom-one-light grvsc-container"data-index=4 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk5>module</span><span class=mtk1>.</span><span class=mtk5>exports</span><span class=mtk1> </span><span class=mtk8>=</span><span class=mtk1> {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk5>moduleFileExtensions</span><span class=mtk8>:</span><span class=mtk1> [</span><span class=mtk10>'js'</span><span class=mtk1>],</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk5>roots</span><span class=mtk8>:</span><span class=mtk1> [</span><span class=mtk10>'./output'</span><span class=mtk1>],</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk5>testMatch</span><span class=mtk8>:</span><span class=mtk1> [</span><span class=mtk10>'&#60rootDir>/**/*.Test.js'</span><span class=mtk1>],</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk5>coveragePathIgnorePatterns</span><span class=mtk8>:</span><span class=mtk1> [</span><span class=mtk10>'/</span><span class=mtk8>\.</span><span class=mtk10>fable/'</span><span class=mtk1>, </span><span class=mtk10>'/[fF]able.*/'</span><span class=mtk1>, </span><span class=mtk10>'/node_modules/'</span><span class=mtk1>],</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk5>testEnvironment</span><span class=mtk8>:</span><span class=mtk1> </span><span class=mtk10>'node'</span><span class=mtk1>,</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk5>transform</span><span class=mtk8>:</span><span class=mtk1> {}</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>};</span></span></span></code></pre><p><code>roots</code> should be equal to the <code>outDir</code> of the compiler. <code>testMatch</code> indicate file pattern name with test. <code>coveragePathIgnorePatterns</code>, <code>testEnvironment</code>, <code>transform</code> improve performance of runner. You can read Jest doc to see more : <a href=https://jestjs.io/docs/en/configuration>https://jestjs.io/docs/en/configuration</a><p>Now, you can run then tests:<pre class="atom-one-light grvsc-container"data-index=5 data-language=sh><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>  npx jest --config=jest.config.js</span></span></span></code></pre><p>Youhou! You can see the test result :)<p>You can specify this command on npm in <code>package.json</code> :<pre class="atom-one-light grvsc-container"data-index=6 data-language=json><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>{</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk5>"scripts"</span><span class=mtk1>: {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk5>"test"</span><span class=mtk1>: </span><span class=mtk10>"dotnet fable src -o output --run jest --config=jest.config.js"</span><span class=mtk1>,</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  },</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>}</span></span></span></code></pre><p>And now run with a single command:<pre class="atom-one-light grvsc-container"data-index=7 data-language=sh><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>  npm </span><span class=mtk8>test</span></span></span></code></pre><h2 id=watch-mode>Watch mode<a href=#watch-mode aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>Running tests each time is slow. You can use the watch feature to take advantage of the compiler and runner cache, and run tests whenever a file changes.<p>Currently, Fable doesn't have official plugins for the different runners. So you have to execute these two commands in parallel:<pre class="atom-one-light grvsc-container"data-index=8 data-language=sh><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>  dotnet fable watch src -o output</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  npx jest --config=jest.config.js --watchAll</span></span></span></code></pre><p>You add an npm script in <code>package.json</code> :<pre class="atom-one-light grvsc-container"data-index=9 data-language=json><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>{</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk5>"scripts"</span><span class=mtk1>: {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk5>"test"</span><span class=mtk1>: </span><span class=mtk10>"dotnet fable src -o output &#38&#38 jest --config=jest.config.js"</span><span class=mtk1>,</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk5>"watch-test:build"</span><span class=mtk1>: </span><span class=mtk10>"dotnet fable watch src -o output"</span><span class=mtk1>,</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk5>"watch-test:run"</span><span class=mtk1>: </span><span class=mtk10>"jest --config=jest.config.js --watchAll"</span><span class=mtk1>,</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk5>"watch-test"</span><span class=mtk1>: </span><span class=mtk10>"npm-run-all --parallel watch-test:*"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  },</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>}</span></span></span></code></pre><p>I use <code>npm-run-all</code> to run several commands in parallel. You should install with:<pre class="atom-one-light grvsc-container"data-index=10 data-language=sh><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>  npm install --save-dev npm-run-all</span></span></span></code></pre><p>Now, run<pre class="atom-one-light grvsc-container"data-index=11 data-language=sh><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>  npm run-script watch-test</span></span></span></code></pre><p>Enjoy :)</div></div></section><div class="section bd-docs-pagination bd-pagination-links"><a class="button bd-fat-button is-primary is-light bd-pagination-prev" href="/docs/your-fable-project/build-and-run.html"><i>←</i><span class="is-hidden-mobile"><em>Your Fable project</em><strong>Build &amp; run</strong></span></a><a class="button bd-fat-button is-primary is-light bd-pagination-next" href="/docs/communicate/js-from-fable.html"><span class="is-hidden-mobile"><em>Communicate with Javascript</em><strong>Call JS from Fable</strong></span><i>→</i></a></div></div></div></div></div><script async="" src="/resources/nacara-standard-layouts/scripts/menu.js"></script></body></html>