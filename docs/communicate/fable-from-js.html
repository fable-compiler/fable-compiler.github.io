<html class="has-navbar-fixed-top" lang="en"><head><title>Fable · Call Fable from JavaScript</title><meta http-equiv="content-type" content="text/html; charset=UTF-8" charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" type="text/css" href="/style.css"/><script src="https://unpkg.com/scroll-into-view-if-needed@2.2.28/umd/scroll-into-view-if-needed.min.js"></script></head><body><nav class="navbar is-fixed-top is-spaced"><div class="container"><div class="navbar-brand"><a class="navbar-item title is-4" href="https://fable.io/">Fable</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/docs">Documentation</a><a class="navbar-item is-hidden-mobile" href="/packages/">Packages</a><a class="navbar-item is-hidden-mobile" href="/repl/">Try</a><a class="navbar-item" href="/blog/index.html">Blog</a><a class="navbar-item is-hidden-mobile" href="/community.html">Community</a><a class="navbar-item is-hidden-mobile" href="/resources.html">Resources</a><div class="navbar-item navbar-burger-dots is-hidden-tablet"><svg height="4" stroke="none" viewBox="0 0 22 4" width="22"><circle cx="2" cy="2" r="2"></circle><circle cx="2" cy="2" r="2" transform="translate(9,0)"></circle><circle cx="2" cy="2" r="2" transform="translate(18,0)"></circle></svg></div></div><div class="navbar-end is-hidden-mobile"><a class="navbar-item" href="https://github.com/fable-compiler/fable"><span class="icon"><i class=" fab fa-github fa-lg"></i></span></a><a class="navbar-item" href="https://twitter.com/FableCompiler"><span class="icon"><i class=" fab fa-twitter fa-lg"></i></span></a><a class="navbar-item" href="https://gitter.im/fable-compiler/Fable"><span class="icon"><i class=" fab fa-gitter fa-lg"></i></span></a><a class="navbar-item" href="https://www.youtube.com/channel/UC6m70Jyr65ogDySbK7aMmzg/videos"><span class="icon"><i class=" fab fa-youtube fa-lg"></i></span></a></div></div><div class="nacara-navbar-menu"><a class="nacara-navbar-menu-item" href="/packages/">Packages</a><a class="nacara-navbar-menu-item" href="/repl/">Try</a><a class="nacara-navbar-menu-item" href="/community.html">Community</a><a class="nacara-navbar-menu-item" href="/resources.html">Resources</a><a class="nacara-navbar-menu-item" href="https://github.com/fable-compiler/fable">Github</a><a class="nacara-navbar-menu-item" href="https://twitter.com/FableCompiler">Twitter</a><a class="nacara-navbar-menu-item" href="https://gitter.im/fable-compiler/Fable">Gitter</a><a class="nacara-navbar-menu-item" href="https://www.youtube.com/channel/UC6m70Jyr65ogDySbK7aMmzg/videos">Youtube</a></div></div></nav><div class="grey-overlay"></div><div class="nacara-content"><div class="container"><div class="mobile-menu"><nav class="breadcrumb"><ul><li><a class="menu-trigger"><span></span><span></span><span></span></a></li><li class="is-active"><a>Documentation</a></li><li class="is-active"><a>Communicate with Javascript</a></li><li class="is-active"><a>Call Fable from JavaScript</a></li></ul></nav></div><div class="columns is-gapless is-mobile"><div class="column is-menu-column is-3-desktop is-hidden-touch"><div class="menu-container"><aside class="menu"><p class="menu-label">Introduction</p><ul class="menu-list"><li><a class=" " href="/docs/index.html">What is Fable?</a></li><li><a class=" " href="/docs/introduction/dotnet-users-read-this.html">Are you a .NET developer?</a></li><li><a class=" " href="/docs/introduction/js-users-read-this.html">Are you a JS developer?</a></li></ul><p class="menu-label">New to F#?</p><ul class="menu-list"><li><a class=" " href="/docs/new-to-fsharp/learning-the-language.html">Learning the language</a></li><li><a class=" " href="/docs/new-to-fsharp/let-keyword.html">The let keyword</a></li></ul><p class="menu-label">Fable in 2 steps</p><ul class="menu-list"><li><a class=" " href="/docs/2-steps/setup.html">Setup</a></li><li><a class=" " href="/docs/2-steps/your-first-fable-project.html">Start a new project</a></li></ul><p class="menu-label">Your Fable project</p><ul class="menu-list"><li><a class=" " href="/docs/your-fable-project/project-file.html">The project file</a></li><li><a class=" " href="/docs/your-fable-project/use-a-fable-library.html">Use a Fable library</a></li><li><a class=" " href="/docs/your-fable-project/author-a-fable-library.html">Author a Fable library</a></li><li><a class=" " href="/docs/your-fable-project/build-and-run.html">Build &amp; run</a></li><li><a class=" " href="/docs/your-fable-project/testing.html">Testing</a></li></ul><p class="menu-label">Communicate with Javascript</p><ul class="menu-list"><li><a class=" " href="/docs/communicate/js-from-fable.html">Call JS from Fable</a></li><li><a class=" is-active" href="/docs/communicate/fable-from-js.html">Call Fable from JavaScript</a></li><li><ul class="table-of-content"><li data-toc-rank="2"><a href="#name-mangling" data-toc-element="true">Name mangling</a></li><li data-toc-rank="2"><a href="#common-types-and-objects" data-toc-element="true">Common types and objects</a></li><li data-toc-rank="2"><a href="#functions-automatic-uncurrying" data-toc-element="true">Functions: automatic uncurrying</a></li><li data-toc-rank="2"><a href="#call-fable-source-code-from-a-js-file" data-toc-element="true">Call Fable source code from a JS file</a></li><li data-toc-rank="2"><a href="#call-fable-compiled-code-as-a-library" data-toc-element="true">Call Fable compiled code as a library</a></li></ul></li></ul><p class="menu-label">From .NET to Fable</p><ul class="menu-list"><li><a class=" " href="/docs/dotnet/compatibility.html">.NET and F# compatibility</a></li><li><a class=" " href="/docs/dotnet/numbers.html">Numeric types</a></li></ul><p class="menu-label">Miscellaneous</p><ul class="menu-list"><li><a class=" " href="/docs/miscellaneous/official-samples.html">Check official samples</a></li><li><a class=" " href="/docs/miscellaneous/fable-in-videos.html">Fable in videos</a></li></ul></aside></div></div><div class="column is-9-desktop is-full-touch"><section class="section"><div class="content"><header class="page-header"><div class="columns is-vcentered"><div class="column"><nav class="breadcrumb is-category-navigation is-hidden-touch"><ul><li class="is-active"><a>Documentation</a></li><li class="is-active"><a>Communicate with Javascript</a></li><li class="is-active"><a>Call Fable from JavaScript</a></li></ul></nav></div><div class="column is-narrow"><a class="button is-hidden-touch is-ghost" target="_blank" href="https://github.com/fable-compiler/fable-compiler.github.io/edit/dev/docs/docs/communicate/fable-from-js.md">Edit</a></div></div><h1 class="title is-1">Call Fable from JavaScript</h1></header><div><style class=grvsc-styles>.grvsc-container{overflow:auto;position:relative;-webkit-overflow-scrolling:touch;padding-top:1rem;padding-top:var(--grvsc-padding-top,var(--grvsc-padding-v,1rem));padding-bottom:1rem;padding-bottom:var(--grvsc-padding-bottom,var(--grvsc-padding-v,1rem));border-radius:8px;border-radius:var(--grvsc-border-radius,8px);font-feature-settings:normal;line-height:1.4}.grvsc-code{display:table}.grvsc-line{display:table-row;box-sizing:border-box;width:100%;position:relative}.grvsc-line>*{position:relative}.grvsc-gutter-pad{display:table-cell;padding-left:.75rem;padding-left:calc(var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem))/ 2)}.grvsc-gutter{display:table-cell;-webkit-user-select:none;-moz-user-select:none;user-select:none}.grvsc-gutter::before{content:attr(data-content)}.grvsc-source{display:table-cell;padding-left:1.5rem;padding-left:var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem));padding-right:1.5rem;padding-right:var(--grvsc-padding-right,var(--grvsc-padding-h,1.5rem))}.grvsc-source:empty::after{content:' ';-webkit-user-select:none;-moz-user-select:none;user-select:none}.grvsc-gutter+.grvsc-source{padding-left:.75rem;padding-left:calc(var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem))/ 2)}.grvsc-has-line-highlighting>.grvsc-code>.grvsc-line::before{content:' ';position:absolute;width:100%}.grvsc-line-diff-add::before{background-color:var(--grvsc-line-diff-add-background-color,rgba(0,255,60,.2))}.grvsc-line-diff-del::before{background-color:var(--grvsc-line-diff-del-background-color,rgba(255,0,20,.2))}.grvsc-line-number{padding:0 2px;text-align:right;opacity:.7}.atom-one-light{background-color:#fafafa;color:#383a42}.atom-one-light .mtki{font-style:italic}.atom-one-light .mtk7{color:#a0a1a7}.atom-one-light .mtk14{color:#a626a4}.atom-one-light .mtk9{color:#4078f2}.atom-one-light .mtk1{color:#383a42}.atom-one-light .mtk5{color:#e45649}.atom-one-light .mtk4{color:#c18401}.atom-one-light .mtk6{color:#986801}.atom-one-light .mtk10{color:#50a14f}.atom-one-light .mtk8{color:#0184bc}.atom-one-light .grvsc-line-highlighted::before{background-color:var(--grvsc-line-highlighted-background-color,rgba(0,0,0,.05));box-shadow:inset var(--grvsc-line-highlighted-border-width,4px) 0 0 0 var(--grvsc-line-highlighted-border-color,rgba(0,0,0,.2))}</style><p>Sometimes, we'd like to use the power of Fable in our JavaScript apps. For instance, to create a new <a href=https://nodered.org/docs/creating-nodes/first-node>js node in Node-RED</a> or call some handy F# code from our new Node.js serverless function or even call some powerful json parsing into our JavaScript app.<p>It may allow you to play with Fable and add features, one at a time. So what does it take to call Fable from JavaScript? First you need to understand a bit how the generated JS code looks like so you can call it correctly.<blockquote><p>Remember you can use the <a href=https://fable.io/repl/>Fable REPL</a> to easily check the generated JS for your F# code!</blockquote><h2 id=name-mangling>Name mangling<a href=#name-mangling aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>Because JS doesn't support overloading or multiple modules in a single file, Fable needs to mangle the name of some members to avoid clashes, which makes it difficult to call such functions or values from JS. However, there're some cases where Fable guarantees names won't change in order to improve interop:<ul><li>Record fields<li>Interface and abstract members<li>Functions and values in the root module</ul><p>What's a root module? Because F# accepts multiple modules in the same file, we consider the root module the first one containing actual members and is not nested by any other.<pre class="atom-one-light grvsc-container"data-index=0 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// It doesn't matter if we have a long namespace, Fable only starts</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// counting when it finds actual code</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>module</span><span class=mtk9> A.Long.Namespace.RootModule</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// The name of this function will be the same in JS</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>add</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>x</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>y</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> x </span><span class=mtk14>+</span><span class=mtk1> y</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>module</span><span class=mtk9> Nested </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class="mtk7 mtki">// This will be prefixed with the name of the module in JS</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>add</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>x</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>y</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> x </span><span class=mtk14>*</span><span class=mtk1> y</span></span></span></code></pre><p>In F# it's possible to have more than one root module in a single file, in that case everything will be mangled. You should avoid this pattern if you want to expose code to JS:<pre class="atom-one-light grvsc-container"data-index=1 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>namespace</span><span class=mtk9> SharedNamespace</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Here both functions will be mangled</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// to prevent name conflicts</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>module</span><span class=mtk9> Foo </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>add</span><span class=mtk1> x y </span><span class=mtk14>=</span><span class=mtk1> x </span><span class=mtk14>+</span><span class=mtk1> y</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>module</span><span class=mtk9> Bar </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>add</span><span class=mtk1> x y </span><span class=mtk14>=</span><span class=mtk1> x </span><span class=mtk14>*</span><span class=mtk1> y</span></span></span></code></pre><h3 id=custom-behaviour>Custom behaviour<a href=#custom-behaviour aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h3><p>In some cases, it's possible to change the default behavior towards name mangling:<ul><li>If you want to have all members attached to a class (as in standard JS classes) and not-mangled use the <code>AttachMembers</code> attribute. But be aware <strong>overloads won't work</strong> in this case.<li>If you are not planning to use an interface to interact with JS and want to have overloaded members, you can decorate the interface declaration with the <code>Mangle</code> attribute. Note: Interfaces coming from .NET BCL (like System.Collections.IEnumerator) are mangled by default.</ul><h2 id=common-types-and-objects>Common types and objects<a href=#common-types-and-objects aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>Some F#/.NET types have <a href=/../dotnet/compatibility.html>counterparts in JS</a>. Fable takes advantage of this to compile to native types that are more performant and reduce bundle size. You can also use this to improve interop when exchanging data between F# and JS. The most important common types are:<ul><li><strong>Strings and booleans</strong> behave the same in F# and JS.<li><strong>Chars</strong> are compiled as JS strings of length 1. This is mainly because string indexing in JS gives you another string. But you can use a char as a number with an explicit conversion like <code>int16 '家'</code>.<li><strong>Numeric types</strong> compile to JS numbers, except for <code>long</code>, <code>decimal</code> and <code>bigint</code>.<li><strong>Arrays</strong> (and <code>ResizeArray</code>) compile to JS arrays. <em>Numeric arrays</em> compile to <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray>Typed Arrays</a> in most situations, though this shouldn't make a difference for most common operations like indexing, iterating or mapping. You can disable this behavior with <a href=https://www.npmjs.com/package/fable-loader#options>the <code>typedArrays</code> option</a>.<li>Any <strong>IEnumerable</strong> (or <code>seq</code>) can be traversed in JS as if it were an <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators#Iterables>Iterable</a>.<li><strong>DateTime</strong> compiles to JS <code>Date</code>.<li><strong>Regex</strong> compiles to JS <code>RegExp</code>.<li>Mutable <strong>dictionaries</strong> (not F# maps) compile to <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map>ES2015 Map</a>.<li>Mutable <strong>hashsets</strong> (not F# sets) compile to <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set>ES2015 Set</a>.</ul><blockquote><p>If the dictionary or hashset requires custom or structural equality, Fable will generate a custom type, but it will share the same properties as JS maps and sets.</blockquote><ul><li><strong>Objects</strong>: As seen above, only record fields and interface members will be attached to objects without name mangling. Take this into account when sending to or receiving an object from JS.</ul><pre class="atom-one-light grvsc-container"data-index=2 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>MyRecord</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>{</span><span class=mtk1> Value</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>      Add</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int </span><span class=mtk14>-></span><span class=mtk4> int </span><span class=mtk14>-></span><span class=mtk4> int </span><span class=mtk14>}</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>member</span><span class=mtk1> </span><span class=mtk5>this.FiveTimes</span><span class=mtk6>()</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        this.Value </span><span class=mtk14>*</span><span class=mtk1> </span><span class=mtk6>5</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>IMyInterface</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>abstract</span><span class=mtk1> Square</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>unit</span><span class=mtk1> </span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk4>float</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>MyClass</span><span class=mtk14>(</span><span class=mtk1>value</span><span class=mtk14>:</span><span class=mtk4> float</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>member</span><span class=mtk1> </span><span class=mtk5>__.Value</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> value</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>interface</span><span class=mtk1> IMyInterface </span><span class=mtk14>with</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        </span><span class=mtk14>member</span><span class=mtk1> </span><span class=mtk5>__.Square</span><span class=mtk6>()</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> value </span><span class=mtk14>*</span><span class=mtk1> value</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>createRecord</span><span class=mtk14>(</span><span class=mtk1>value</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>{</span><span class=mtk1> Value </span><span class=mtk14>=</span><span class=mtk1> value</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>      Add </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk14>fun</span><span class=mtk1> x y </span><span class=mtk14>-></span><span class=mtk1> x </span><span class=mtk14>+</span><span class=mtk1> y </span><span class=mtk14>}</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>createClass</span><span class=mtk14>(</span><span class=mtk1>value</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>float</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    MyClass</span><span class=mtk14>(</span><span class=mtk1>value</span><span class=mtk14>)</span></span></span></code></pre><pre class="atom-one-light grvsc-container"data-index=3 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>import</span><span class=mtk1> { </span><span class=mtk5>createRecord</span><span class=mtk1>, </span><span class=mtk5>createClass</span><span class=mtk1> } </span><span class=mtk14>from</span><span class=mtk1> </span><span class=mtk10>"./Tests.fs"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>var</span><span class=mtk1> record </span><span class=mtk8>=</span><span class=mtk1> </span><span class=mtk9>createRecord</span><span class=mtk1>(</span><span class=mtk6>2</span><span class=mtk1>);</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Ok, we're calling a record field</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>record.</span><span class=mtk9>Add</span><span class=mtk1>(record.</span><span class=mtk5>Value</span><span class=mtk1>, </span><span class=mtk6>2</span><span class=mtk1>); </span><span class="mtk7 mtki">// 4</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Fails, this member is not actually attached to the object</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>record.</span><span class=mtk9>FiveTimes</span><span class=mtk1>();</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>var</span><span class=mtk1> myClass </span><span class=mtk8>=</span><span class=mtk1> </span><span class=mtk9>createClass</span><span class=mtk1>(</span><span class=mtk6>5</span><span class=mtk1>);</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Fails</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>myClass.</span><span class=mtk5>Value</span><span class=mtk1>;</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Ok, this is an interface member</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>myClass.</span><span class=mtk9>Square</span><span class=mtk1>(); </span><span class="mtk7 mtki">// 25</span></span></span></code></pre><h2 id=functions-automatic-uncurrying>Functions: automatic uncurrying<a href=#functions-automatic-uncurrying aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>Fable will automatically uncurry functions in many situations: when they're passed as functions, when set as a record field... So in most cases you can pass them to and from JS as if they were functions without curried arguments.<pre class="atom-one-light grvsc-container"data-index=4 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>execute</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>f</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk14>-></span><span class=mtk4>int</span><span class=mtk14>-></span><span class=mtk4>int</span><span class=mtk14>)</span><span class=mtk1> x y </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    f x y</span></span></span></code></pre><pre class="atom-one-light grvsc-container"data-index=5 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>import</span><span class=mtk1> { </span><span class=mtk5>execute</span><span class=mtk1> } </span><span class=mtk14>from</span><span class=mtk1> </span><span class=mtk10>"./TestFunctions.fs"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk9>execute</span><span class=mtk1>(</span><span class=mtk14>function</span><span class=mtk1> (x, y) { </span><span class=mtk14>return</span><span class=mtk1> x </span><span class=mtk8>*</span><span class=mtk1> y }, </span><span class=mtk6>3</span><span class=mtk1>, </span><span class=mtk6>5</span><span class=mtk1>) </span><span class="mtk7 mtki">// 15</span></span></span></code></pre><blockquote><p>Check <a href=https://fsharpforfunandprofit.com/posts/currying/>this</a> for more information on function currying in F# (and other functional languages).</blockquote><h3 id=using-delegates-for-disambiguation>Using delegates for disambiguation<a href=#using-delegates-for-disambiguation aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h3><p>There are some situations where Fable uncurrying mechanism can get confused, particularly with functions that return other functions. Let's consider the following example:<pre class="atom-one-light grvsc-container"data-index=6 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core.JsInterop</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>myEffect</span><span class=mtk6>()</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    printfn </span><span class=mtk10>"Effect!"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>fun</span><span class=mtk1> </span><span class=mtk14>()</span><span class=mtk1> </span><span class=mtk14>-></span><span class=mtk1> printfn </span><span class=mtk10>"Cleaning up"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Method from a JS module, expects a function</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// that returns another function for disposing</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>useEffect</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>effect</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>unit </span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk4>unit </span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk4>unit</span><span class=mtk14>)):</span><span class=mtk1> </span><span class=mtk4>unit </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    importMember </span><span class=mtk10>"my-js-module"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Fails, Fable thinks this is a 2-arity function</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>useEffect myEffect</span></span></span></code></pre><p>The problem here is the compiler cannot tell <code>unit -> unit -> unit</code> apart from <code>unit -> (unit -> unit)</code>, it can only see a 2-arity lambda (a function accepting two arguments). This won't be an issue if all your code is in F#, but if you're sending the function to JS as in this case, Fable will incorrectly try to uncurry it causing unexpected results.<p>To disambiguate these cases, you can use <a href=https://docs.microsoft.com/en-us/dotnet/fsharp/language-reference/delegates>delegates</a>, like <code>System.Func</code> which are not curried:<pre class="atom-one-light grvsc-container"data-index=7 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>System</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Remove the ambiguity by using a delegate</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>useEffect</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>effect</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>Func</span><span class=mtk14>&lt;</span><span class=mtk6>unit</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk4>unit </span><span class=mtk14>-></span><span class=mtk4> unit</span><span class=mtk14>)>):</span><span class=mtk1> </span><span class=mtk4>unit </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    importMember </span><span class=mtk10>"my-js-module"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Works</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>useEffect</span><span class=mtk14>(</span><span class=mtk1>Func</span><span class=mtk14>&#60_,_></span><span class=mtk1> myEffect</span><span class=mtk14>)</span></span></span></code></pre><h2 id=call-fable-source-code-from-a-js-file>Call Fable source code from a JS file<a href=#call-fable-source-code-from-a-js-file aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>Webpack makes it very easy to include files in different programming languages in your project by using loaders. Because in a Fable project we assume you're already using the <a href=https://www.npmjs.com/package/fable-loader>fable-loader</a>, if you have a file like the following:<pre class="atom-one-light grvsc-container"data-index=8 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>module</span><span class=mtk9> HelloFable</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>sayHelloFable</span><span class=mtk6>()</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk10>"Hello Fable!"</span></span></span></code></pre><p>Importing and using it from JS is as simple as if it were another JS file:<pre class="atom-one-light grvsc-container"data-index=9 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>import</span><span class=mtk1> { </span><span class=mtk5>sayHelloFable</span><span class=mtk1> } </span><span class=mtk14>from</span><span class=mtk1> </span><span class=mtk10>"./HelloFable.fs"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk4>console</span><span class=mtk1>.</span><span class=mtk8>log</span><span class=mtk1>(</span><span class=mtk9>sayHelloFable</span><span class=mtk1>());</span></span></span></code></pre><h3 id=importing-fable-code-from-typescript>Importing Fable code from Typescript<a href=#importing-fable-code-from-typescript aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h3><p>For better or worse, Typescript wants to check your imported modules and because it doesn't know a thing of F#, it will complain if you try to import an .fs file:<pre class="atom-one-light grvsc-container"data-index=10 data-language=ts><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Typescript will complain because it cannot read the file</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>import</span><span class=mtk1> { </span><span class=mtk5>sayHelloFable</span><span class=mtk1> } </span><span class=mtk14>from</span><span class=mtk1> </span><span class=mtk10>"./HelloFable.fs"</span></span></span></code></pre><p>To appease the Typescript compiler, we need a <a href=https://www.typescriptlang.org/docs/handbook/declaration-files/introduction.html>declaration file</a>, which also gives us the opportunity to tell Typescript what is actually exported by our Fable code. If you place a <code>HelloFable.d.ts</code> file like the following, the import above will work:<pre class="atom-one-light grvsc-container"data-index=11 data-language=ts><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Unfortunately declaration files don't accept relative paths</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// so we just use the * wildcard</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>declare</span><span class=mtk1> </span><span class=mtk14>module</span><span class=mtk1> </span><span class=mtk10>"*HelloFable.fs"</span><span class=mtk1> {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>function</span><span class=mtk1> </span><span class=mtk9>sayHelloFable</span><span class=mtk1>()</span><span class=mtk8>:</span><span class=mtk1> </span><span class=mtk8>string</span><span class=mtk1>;</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>}</span></span></span></code></pre><h2 id=call-fable-compiled-code-as-a-library>Call Fable compiled code as a library<a href=#call-fable-compiled-code-as-a-library aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><h3 id=from-your-web-app>..from your web app<a href=#from-your-web-app aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h3><p>If your project is a web app and you're using Webpack, it just takes two lines of code in the Webpack configuration in the <code>output</code> section of <code>module.exports</code>:<pre class="atom-one-light grvsc-container"data-index=12 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>libraryTarget: </span><span class=mtk10>'var'</span><span class=mtk1>,</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>library: </span><span class=mtk10>'MyFableLib'</span></span></span></code></pre><p>For instance:<pre class="atom-one-light grvsc-container"data-index=13 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>    output: {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        path: path.</span><span class=mtk9>join</span><span class=mtk1>(</span><span class=mtk5>__dirname</span><span class=mtk1>, </span><span class=mtk10>"./public"</span><span class=mtk1>),</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        filename: </span><span class=mtk10>"bundle.js"</span><span class=mtk1>,</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        libraryTarget: </span><span class=mtk10>'var'</span><span class=mtk1>,</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        library: </span><span class=mtk10>'MyFableLib'</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    },</span></span></span></code></pre><p>This tells Webpack that we want our Fable code to be available from a global variable named <code>MyFableLib</code>. That's it!<article class="is-info message"><div class=message-body><div><p>Only the public functions and values in the <strong>last file of the project</strong> will be exposed.</div></div></article><h4 id=lets-try>Let's try!<a href=#lets-try aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h4><p>Let's compile the HelloFable app from above with a webpack.config.js that includes the following:<pre class="atom-one-light grvsc-container"data-index=14 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>output: {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk8>...</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    libraryTarget: </span><span class=mtk10>'var'</span><span class=mtk1>,</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    library: </span><span class=mtk10>'OMGFable'</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>}</span></span></span></code></pre><p>Now let's try this directly in our <code>index.html</code> file:<pre class="atom-one-light grvsc-container"data-index=15 data-language=html><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>&lt;</span><span class=mtk5>body</span><span class=mtk1>></span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    &lt;</span><span class=mtk5>script</span><span class=mtk1> </span><span class=mtk6>src</span><span class=mtk1>=</span><span class=mtk10>"bundle.js"</span><span class=mtk1>>&#60/</span><span class=mtk5>script</span><span class=mtk1>></span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    &lt;</span><span class=mtk5>script</span><span class=mtk1> </span><span class=mtk6>type</span><span class=mtk1>=</span><span class=mtk10>"text/JavaScript"</span><span class=mtk1>></span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>      </span><span class=mtk9>alert</span><span class=mtk1>( OMGFable.</span><span class=mtk9>sayHelloFable</span><span class=mtk1>() );</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    &#60/</span><span class=mtk5>script</span><span class=mtk1>></span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>&#60/</span><span class=mtk5>body</span><span class=mtk1>></span></span></span></code></pre><p>Et voilà! We're done! You can find a <a href=https://github.com/fable-compiler/fable2-samples/tree/master/interopFableFromJS>full sample here</a>.<h3 id=from-your-nodejs-app>...from your Node.js app<a href=#from-your-nodejs-app aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h3><p>Basically it's the same thing. If you want to see a complete sample using a <code>commonjs</code> output instead of <code>var</code>, please <a href=https://github.com/fable-compiler/fable2-samples/tree/master/nodejsbundle>check this project</a>. There you'll see that we've added the following lines to the Webpack config:<pre class="atom-one-light grvsc-container"data-index=16 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>    library:</span><span class=mtk10>"app"</span><span class=mtk1>,</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    libraryTarget: </span><span class=mtk10>'commonjs'</span></span></span></code></pre><p>and then you can call your code from JavaScript like this:<pre class="atom-one-light grvsc-container"data-index=17 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> app </span><span class=mtk8>=</span><span class=mtk1> </span><span class=mtk8>require</span><span class=mtk1>(</span><span class=mtk10>"./App.js"</span><span class=mtk1>);</span></span></span></code></pre><h3 id=learn-more-about-webpack-librarytarget>Learn more about Webpack <code>libraryTarget</code><a href=#learn-more-about-webpack-librarytarget aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h3><p>If you want to know what your options are, please consult the <a href=https://webpack.js.org/configuration/output/#outputlibrarytarget>official documentation</a>.</div></div></section><div class="section bd-docs-pagination bd-pagination-links"><a class="button bd-fat-button is-primary is-light bd-pagination-prev" href="/docs/communicate/js-from-fable.html"><i>←</i><span class="is-hidden-mobile"><em>Communicate with Javascript</em><strong>Call JS from Fable</strong></span></a><a class="button bd-fat-button is-primary is-light bd-pagination-next" href="/docs/dotnet/compatibility.html"><span class="is-hidden-mobile"><em>From .NET to Fable</em><strong>.NET and F# compatibility</strong></span><i>→</i></a></div></div></div></div></div><script async="" src="/resources/nacara-standard-layouts/scripts/menu.js"></script></body></html>