<html class="has-navbar-fixed-top" lang="en"><head><title>Fable Â· .NET and F# compatibility</title><meta http-equiv="content-type" content="text/html; charset=UTF-8" charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" type="text/css" href="/style.css"/><script src="https://unpkg.com/scroll-into-view-if-needed@2.2.28/umd/scroll-into-view-if-needed.min.js"></script></head><body><nav class="navbar is-fixed-top is-spaced"><div class="container"><div class="navbar-brand"><a class="navbar-item title is-4" href="https://fable.io/">Fable</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/docs">Documentation</a><a class="navbar-item is-hidden-mobile" href="/packages/">Packages</a><a class="navbar-item is-hidden-mobile" href="/repl/">Try</a><a class="navbar-item" href="/blog/index.html">Blog</a><a class="navbar-item is-hidden-mobile" href="/community.html">Community</a><a class="navbar-item is-hidden-mobile" href="/resources.html">Resources</a><div class="navbar-item navbar-burger-dots is-hidden-tablet"><svg height="4" stroke="none" viewBox="0 0 22 4" width="22"><circle cx="2" cy="2" r="2"></circle><circle cx="2" cy="2" r="2" transform="translate(9,0)"></circle><circle cx="2" cy="2" r="2" transform="translate(18,0)"></circle></svg></div></div><div class="navbar-end is-hidden-mobile"><a class="navbar-item" href="https://github.com/fable-compiler/fable"><span class="icon"><i class=" fab fa-github fa-lg"></i></span></a><a class="navbar-item" href="https://twitter.com/FableCompiler"><span class="icon"><i class=" fab fa-twitter fa-lg"></i></span></a><a class="navbar-item" href="https://gitter.im/fable-compiler/Fable"><span class="icon"><i class=" fab fa-gitter fa-lg"></i></span></a><a class="navbar-item" href="https://www.youtube.com/channel/UC6m70Jyr65ogDySbK7aMmzg/videos"><span class="icon"><i class=" fab fa-youtube fa-lg"></i></span></a></div></div><div class="nacara-navbar-menu"><a class="nacara-navbar-menu-item" href="/packages/">Packages</a><a class="nacara-navbar-menu-item" href="/repl/">Try</a><a class="nacara-navbar-menu-item" href="/community.html">Community</a><a class="nacara-navbar-menu-item" href="/resources.html">Resources</a><a class="nacara-navbar-menu-item" href="https://github.com/fable-compiler/fable">Github</a><a class="nacara-navbar-menu-item" href="https://twitter.com/FableCompiler">Twitter</a><a class="nacara-navbar-menu-item" href="https://gitter.im/fable-compiler/Fable">Gitter</a><a class="nacara-navbar-menu-item" href="https://www.youtube.com/channel/UC6m70Jyr65ogDySbK7aMmzg/videos">Youtube</a></div></div></nav><div class="grey-overlay"></div><div class="nacara-content"><div class="container"><div class="mobile-menu"><nav class="breadcrumb"><ul><li><a class="menu-trigger"><span></span><span></span><span></span></a></li><li class="is-active"><a>Documentation</a></li><li class="is-active"><a>JavaScript</a></li><li class="is-active"><a>.NET and F# compatibility</a></li></ul></nav></div><div class="columns is-gapless is-mobile"><div class="column is-menu-column is-3-desktop is-hidden-touch"><div class="menu-container"><aside class="menu"><p class="menu-label">Introduction</p><ul class="menu-list"><li><a class=" " href="/docs/index.html">What is Fable?</a></li><li><a class=" " href="/docs/introduction/dotnet-users-read-this.html">Are you a .NET developer?</a></li><li><a class=" " href="/docs/introduction/js-users-read-this.html">Are you a JS developer?</a></li></ul><p class="menu-label">Getting started</p><ul class="menu-list"><li><a class=" " href="/docs/getting-started/setup.html">Setup</a></li><li><a class=" " href="/docs/getting-started/your-first-fable-project.html">Start a new project</a></li><li><a class=" " href="/docs/getting-started/javascript.html">JavaScript</a></li><li><a class=" " href="/docs/getting-started/typescript.html">TypeScript</a></li><li><a class=" " href="/docs/getting-started/python.html">Python</a></li><li><a class=" " href="/docs/getting-started/rust.html">Rust</a></li><li><a class=" " href="/docs/getting-started/cli.html">Fable CLI</a></li></ul><p class="menu-label">Your Fable project</p><ul class="menu-list"><li><a class=" " href="/docs/your-fable-project/use-a-fable-library.html">Use a Fable library</a></li><li><a class=" " href="/docs/your-fable-project/author-a-fable-library.html">Author a Fable library</a></li></ul><p class="menu-label">New to F#?</p><ul class="menu-list"><li><a class=" " href="/docs/new-to-fsharp/learning-the-language.html">Learning the language</a></li><li><a class=" " href="/docs/new-to-fsharp/let-keyword.html">The let keyword</a></li><li><a class=" " href="/docs/new-to-fsharp/project-file.html">The project file</a></li></ul><p class="menu-label">JavaScript</p><ul class="menu-list"><li><a class=" " href="/docs/javascript/build-and-run.html">Build and Run</a></li><li><a class=" " href="/docs/javascript/features.html">Features</a></li><li><a class=" is-active" href="/docs/javascript/compatibility.html">.NET and F# compatibility</a></li><li><ul class="table-of-content"><li data-toc-rank="2"><a href="#common-types-and-objects" data-toc-element="true">Common types and objects</a></li><li data-toc-rank="2"><a href="#net-base-class-library" data-toc-element="true">.NET Base Class Library</a></li><li data-toc-rank="2"><a href="#fsharpcore" data-toc-element="true">FSharp.Core</a></li><li data-toc-rank="2"><a href="#object-oriented-programming" data-toc-element="true">Object Oriented Programming</a></li><li data-toc-rank="2"><a href="#reflection-and-generics" data-toc-element="true">Reflection and Generics</a></li><li data-toc-rank="2"><a href="#numeric-types" data-toc-element="true">Numeric types</a></li><li data-toc-rank="2"><a href="#unsupported-attributes-and-types" data-toc-element="true">Unsupported Attributes and Types</a></li></ul></li></ul><p class="menu-label">TypeScript</p><ul class="menu-list"><li><a class=" " href="/docs/typescript/build-and-run.html">Build and Run</a></li><li><a class=" " href="/docs/typescript/features.html">Features</a></li><li><a class=" " href="/docs/typescript/compatibility.html">.NET and F# compatibility</a></li></ul><p class="menu-label">Python</p><ul class="menu-list"><li><a class=" " href="/docs/python/build-and-run.html">Build and Run</a></li><li><a class=" " href="/docs/python/features.html">Features</a></li><li><a class=" " href="/docs/python/compatibility.html">.NET and F# compatibility</a></li></ul><p class="menu-label">Miscellaneous</p><ul class="menu-list"><li><a class=" " href="/docs/miscellaneous/official-samples.html">Check official samples</a></li><li><a class=" " href="/docs/miscellaneous/fable-in-videos.html">Fable in videos</a></li></ul></aside></div></div><div class="column is-9-desktop is-full-touch"><section class="section"><div class="content"><header class="page-header"><div class="columns is-vcentered"><div class="column"><nav class="breadcrumb is-category-navigation is-hidden-touch"><ul><li class="is-active"><a>Documentation</a></li><li class="is-active"><a>JavaScript</a></li><li class="is-active"><a>.NET and F# compatibility</a></li></ul></nav></div><div class="column is-narrow"><a class="button is-hidden-touch is-ghost" target="_blank" href="https://github.com/fable-compiler/fable-compiler.github.io/edit/dev/docs/docs/javascript/compatibility.md">Edit</a></div></div><h1 class="title is-1">.NET and F# compatibility</h1></header><div><style class=grvsc-styles>.grvsc-container{overflow:auto;position:relative;-webkit-overflow-scrolling:touch;padding-top:1rem;padding-top:var(--grvsc-padding-top,var(--grvsc-padding-v,1rem));padding-bottom:1rem;padding-bottom:var(--grvsc-padding-bottom,var(--grvsc-padding-v,1rem));border-radius:8px;border-radius:var(--grvsc-border-radius,8px);font-feature-settings:normal;line-height:1.4}.grvsc-code{display:table}.grvsc-line{display:table-row;box-sizing:border-box;width:100%;position:relative}.grvsc-line>*{position:relative}.grvsc-gutter-pad{display:table-cell;padding-left:.75rem;padding-left:calc(var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem))/ 2)}.grvsc-gutter{display:table-cell;-webkit-user-select:none;-moz-user-select:none;user-select:none}.grvsc-gutter::before{content:attr(data-content)}.grvsc-source{display:table-cell;padding-left:1.5rem;padding-left:var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem));padding-right:1.5rem;padding-right:var(--grvsc-padding-right,var(--grvsc-padding-h,1.5rem))}.grvsc-source:empty::after{content:' ';-webkit-user-select:none;-moz-user-select:none;user-select:none}.grvsc-gutter+.grvsc-source{padding-left:.75rem;padding-left:calc(var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem))/ 2)}.grvsc-has-line-highlighting>.grvsc-code>.grvsc-line::before{content:' ';position:absolute;width:100%}.grvsc-line-diff-add::before{background-color:var(--grvsc-line-diff-add-background-color,rgba(0,255,60,.2))}.grvsc-line-diff-del::before{background-color:var(--grvsc-line-diff-del-background-color,rgba(255,0,20,.2))}.grvsc-line-number{padding:0 2px;text-align:right;opacity:.7}.atom-one-light{background-color:#fafafa;color:#383a42}.atom-one-light .mtki{font-style:italic}.atom-one-light .mtk14{color:#a626a4}.atom-one-light .mtk1{color:#383a42}.atom-one-light .mtk4{color:#c18401}.atom-one-light .mtk5{color:#e45649}.atom-one-light .mtk6{color:#986801}.atom-one-light .mtk10{color:#50a14f}.atom-one-light .mtk8{color:#0184bc}.atom-one-light .mtk9{color:#4078f2}.atom-one-light .mtk7{color:#a0a1a7}.atom-one-light .grvsc-line-highlighted::before{background-color:var(--grvsc-line-highlighted-background-color,rgba(0,0,0,.05));box-shadow:inset var(--grvsc-line-highlighted-border-width,4px) 0 0 0 var(--grvsc-line-highlighted-border-color,rgba(0,0,0,.2))}</style><p>Fable provides support for some classes of .NET BCL (Base Class Library) and most of FSharp.Core library. When possible, Fable translates .NET types and methods to native JavaScript APIs for minimum overhead.<h2 id=common-types-and-objects>Common types and objects<a href=#common-types-and-objects aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>Some F#/.NET types have <a href=/../dotnet/compatibility.html>counterparts in JS</a>. Fable takes advantage of this to compile to native types that are more performant and reduce bundle size. You can also use this to improve interop when exchanging data between F# and JS. The most important common types are:<ul><li><strong>Strings and booleans</strong> behave the same in F# and JS.<li><strong>Chars</strong> are compiled as JS strings of length 1. This is mainly because string indexing in JS gives you another string. But you can use a char as a number with an explicit conversion like <code>int16 'å®¶'</code>.<li><strong>Numeric types</strong> compile to JS numbers, except for <code>long</code>, <code>decimal</code> and <code>bigint</code>.<li>Since Fable 4.0.5, <code>int64</code>, <code>uint64</code> are represented using native JS BigInt<li><strong>Arrays</strong> (and <code>ResizeArray</code>) compile to JS arrays. <em>Numeric arrays</em> compile to <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray>Typed Arrays</a> in most situations, though this shouldn't make a difference for most common operations like indexing, iterating or mapping. You can disable this behavior with <a href=https://www.npmjs.com/package/fable-loader#options>the <code>typedArrays</code> option</a>.<li>Any <strong>IEnumerable</strong> (or <code>seq</code>) can be traversed in JS as if it were an <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators#Iterables>Iterable</a>.<li>Mutable <strong>dictionaries</strong> (not F# maps) compile to <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map>ES2015 Map</a>.<li>Mutable <strong>hashsets</strong> (not F# sets) compile to <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set>ES2015 Set</a>.</ul><blockquote><p>If the dictionary or hashset requires custom or structural equality, Fable will generate a custom type, but it will share the same properties as JS maps and sets.</blockquote><ul><li><strong>Objects</strong>: As seen above, only record fields and interface members will be attached to objects without name mangling. Take this into account when sending to or receiving an object from JS.</ul><pre class="atom-one-light grvsc-container"data-index=0 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>MyRecord</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>{</span><span class=mtk1> Value</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>      Add</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int </span><span class=mtk14>-></span><span class=mtk4> int </span><span class=mtk14>-></span><span class=mtk4> int </span><span class=mtk14>}</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>member</span><span class=mtk1> </span><span class=mtk5>this.FiveTimes</span><span class=mtk6>()</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        this.Value </span><span class=mtk14>*</span><span class=mtk1> </span><span class=mtk6>5</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>IMyInterface</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>abstract</span><span class=mtk1> Square</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>unit</span><span class=mtk1> </span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk4>float</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>MyClass</span><span class=mtk14>(</span><span class=mtk1>value</span><span class=mtk14>:</span><span class=mtk4> float</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>member</span><span class=mtk1> </span><span class=mtk5>__.Value</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> value</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>interface</span><span class=mtk1> IMyInterface </span><span class=mtk14>with</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        </span><span class=mtk14>member</span><span class=mtk1> </span><span class=mtk5>__.Square</span><span class=mtk6>()</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> value </span><span class=mtk14>*</span><span class=mtk1> value</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>createRecord</span><span class=mtk14>(</span><span class=mtk1>value</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>{</span><span class=mtk1> Value </span><span class=mtk14>=</span><span class=mtk1> value</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>      Add </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk14>fun</span><span class=mtk1> x y </span><span class=mtk14>-></span><span class=mtk1> x </span><span class=mtk14>+</span><span class=mtk1> y </span><span class=mtk14>}</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>createClass</span><span class=mtk14>(</span><span class=mtk1>value</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>float</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    MyClass</span><span class=mtk14>(</span><span class=mtk1>value</span><span class=mtk14>)</span></span></span></code></pre><pre class="atom-one-light grvsc-container"data-index=1 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>import</span><span class=mtk1> { </span><span class=mtk5>createRecord</span><span class=mtk1>, </span><span class=mtk5>createClass</span><span class=mtk1> } </span><span class=mtk14>from</span><span class=mtk1> </span><span class=mtk10>"./Tests.fs"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>var</span><span class=mtk1> record </span><span class=mtk8>=</span><span class=mtk1> </span><span class=mtk9>createRecord</span><span class=mtk1>(</span><span class=mtk6>2</span><span class=mtk1>);</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Ok, we're calling a record field</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>record.</span><span class=mtk9>Add</span><span class=mtk1>(record.</span><span class=mtk5>Value</span><span class=mtk1>, </span><span class=mtk6>2</span><span class=mtk1>); </span><span class="mtk7 mtki">// 4</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Fails, this member is not actually attached to the object</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>record.</span><span class=mtk9>FiveTimes</span><span class=mtk1>();</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>var</span><span class=mtk1> myClass </span><span class=mtk8>=</span><span class=mtk1> </span><span class=mtk9>createClass</span><span class=mtk1>(</span><span class=mtk6>5</span><span class=mtk1>);</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Fails</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>myClass.</span><span class=mtk5>Value</span><span class=mtk1>;</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Ok, this is an interface member</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>myClass.</span><span class=mtk9>Square</span><span class=mtk1>(); </span><span class="mtk7 mtki">// 25</span></span></span></code></pre><h2 id=net-base-class-library>.NET Base Class Library<a href=#net-base-class-library aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>The following classes are translated to JS and most of their methods (static and instance) should be available in Fable.<table><thead><tr><th>.NET<th>JavaScript<tbody><tr><td>Numeric Types<td>number<tr><td>Arrays<td>Array / Typed Arrays<tr><td>Events<td>fable-core/Event<tr><td>System.Boolean<td>boolean<tr><td>System.Char<td>string<tr><td>System.String<td>string<tr><td>System.Guid<td>string<tr><td>System.TimeSpan<td>number<tr><td>System.DateTime<td>Date<tr><td>System.DateTimeOffset<td>Date<tr><td>System.DateOnly<td>Date<tr><td>System.TimeOnly<td>number<tr><td>System.Timers.Timer<td>fable-core/Timer<tr><td>System.Collections.Generic.List<td>Array<tr><td>System.Collections.Generic.HashSet<td>Set<tr><td>System.Collections.Generic.Dictionary<td>Map<tr><td>System.Text.RegularExpressions.Regex<td>RegExp<tr><td>System.Lazy<td>fable-core/Lazy<tr><td>System.Random<td>{}<tr><td>System.Math<td>(native JS functions)<tr><td>System.Runtime.CompilerServices.ConditionalWeakTable<td>WeakMap</table><p>The following static methods are also available:<ul><li><code>System.Console.WriteLine</code> (also with formatting)<li><code>System.Diagnostics.Debug.WriteLine</code> (also with formatting)<li><code>System.Diagnostics.Debug.Assert(condition: bool)</code><li><code>System.Diagnostics.Debugger.Break()</code><li><code>System.Activator.CreateInstance&#60'T>()</code></ul><p>There is also support to convert between numeric types and to parse strings, check <a href=https://github.com/fable-compiler/Fable/blob/main/tests/Js/Main/ConvertTests.fs>the conversion tests</a>.<article class="is-info message"><div class=message-body><div><p>Interfaces coming from .NET BCL (like System.Collections.IEnumerator) are mangled by default.<p>See <a href=/docs/javascript/features.html#name-mangling>Name mangling</a> for more information.</div></div></article><h3 id=caveats>Caveats<a href=#caveats aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h3><ul><li>All numeric types become JS <code>number</code> (64-bit floating type), except for <code>int64</code>, <code>uint64</code>, <code>bigint</code> and <code>decimal</code>. Check the <a href=numbers.html>Numeric Types</a> section to learn more about the differences between .NET and JS.<li>Numeric arrays are compiled to <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray>Typed Arrays</a> when possible.<li>No bound checks for numeric types (unless you do explicit conversions like <code>byte 500</code>) nor for array indices.<li><code>Regex</code> will always behave as if passed <code>RegexOptions.ECMAScript</code> flag (e.g., no negative look-behind or named groups).<li><code>ConditionalWeakTable</code> has some limitations: the <code>GetOrCreateValue</code> method is not supported, nor is casting it to <code>IEnumerable</code> and iterating it. If you want to use a string as a key, you must manually box it in a JS <code>String</code> object:</ul><pre class="atom-one-light grvsc-container"data-index=2 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>System.Runtime.CompilerServices</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Only needed for strings as keys; other reference types work fine directly</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let inline</span><span class=mtk1> </span><span class=mtk5>boxString</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>str</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>string</span><span class=mtk14>):</span><span class=mtk1> </span><span class=mtk4>obj </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    #if FABLE</span><span class=mtk14>_</span><span class=mtk1>COMPILER</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    Fable.Core.JsInterop.emitJsExpr </span><span class=mtk14>(</span><span class=mtk1>str</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk10>"new String($0)"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    #else</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    box str</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    #endif</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>table</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> ConditionalWeakTable</span><span class=mtk6>()</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>key</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> boxString </span><span class=mtk10>"my-key"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>value</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk10>"something"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>table.Add</span><span class=mtk14>(</span><span class=mtk1>key</span><span class=mtk14>,</span><span class=mtk1> value</span><span class=mtk14>)</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Use the same `key` object later to get the value..</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>match</span><span class=mtk1> table.TryGetValue</span><span class=mtk14>(</span><span class=mtk1>key</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>with</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>|</span><span class=mtk1> </span><span class=mtk6>true</span><span class=mtk14>,</span><span class=mtk1> value </span><span class=mtk14>-></span><span class=mtk1> </span><span class="mtk7 mtki">// ...</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>|</span><span class=mtk1> </span><span class=mtk14>_</span><span class=mtk1> </span><span class=mtk14>-></span><span class=mtk1> </span><span class="mtk7 mtki">// ...</span></span></span></code></pre><h2 id=fsharpcore>FSharp.Core<a href=#fsharpcore aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>Most of FSharp.Core operators are supported, as well as formatting with <code>sprintf</code>, <code>printfn</code> or <code>failwithf</code> (<code>String.Format</code> is also available). The following types and/or corresponding modules from FSharp.Core lib will likewise translate to JS:<table><thead><tr><th>.NET<th>JavaScript<tbody><tr><td>Tuples<td>Array<tr><td>Option<td>(erased)<tr><td>Choice<td>fable-core/Choice<tr><td>Result<td>fable-core/Result<tr><td>String<td>fable-core/String (module)<tr><td>Seq<td><a href=http://babeljs.io/docs/learn-es2015/#iterators-for-of>Iterable</a><tr><td>List<td>fable-core/List<tr><td>Map<td>fable-core/Map<tr><td>Set<td>fable-core/Set<tr><td>Async<td>fable-core/Async<tr><td>Event<td>fable-core/Event (module)<tr><td>Observable<td>fable-core/Observable (module)<tr><td>Arrays<td>Array / Typed Arrays<tr><td>Events<td>fable-core/Event<tr><td>MailboxProcessor<td>fable-core/MailboxProcessor (limited support)</table><h3 id=caveats-ii>Caveats II<a href=#caveats-ii aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h3><ul><li>Options are <strong>erased</strong> in JS (<code>Some 5</code> becomes just <code>5</code> in JS and <code>None</code> translates to <code>null</code>). This is needed for example, to represent TypeScript <a href=https://www.typescriptlang.org/docs/handbook/interfaces.html#optional-properties>optional properties</a>. However in a few cases (like nested options) there is an actual representation of the option in the runtime.<li><code>Async.RunSynchronously</code> is not supported.<li><code>MailboxProcessor</code> is single-threaded in JS and currently only <code>Start</code>, <code>Receive</code>, <code>Post</code> and <code>PostAndAsyncReply</code> are implemented (<code>cancellationToken</code> or <code>timeout</code> optional arguments are not supported).</ul><h2 id=object-oriented-programming>Object Oriented Programming<a href=#object-oriented-programming aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>Most of F# OOP features are compatible with Fable: interfaces and abstract classes, structs, inheritance, overloading, etc. However, please note that due to some limitations of <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes>ES2015 classes</a> the generated code uses the <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Inheritance_and_the_prototype_chain>prototype chain</a> instead. Also note that instance members are not attached to the prototype, which means they won't be accessible from native JS code. The exception to this rule are the implementations of <strong>interface and abstract members</strong>.<h3 id=caveats-iii>Caveats III<a href=#caveats-iii aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h3><ul><li>It's not possible to type test against interfaces or generic types.</ul><h2 id=reflection-and-generics>Reflection and Generics<a href=#reflection-and-generics aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>There is some reflection support in Fable, you can check the <a href=https://github.com/fable-compiler/Fable/blob/main/tests/Js/Main/ReflectionTests.fs>reflection tests</a> to see what is currently possible.<p>Generics are erased by default in the generated JS code. However, it is still possible to access generic information (like <code>typeof&#60'T></code>) at runtime by marking functions with <code>inline</code>:<pre class="atom-one-light grvsc-container"data-index=3 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>doesNotCompileInFable</span><span class=mtk14>(</span><span class=mtk1>x</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>'T</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    typeof</span><span class=mtk14>&lt;</span><span class=mtk1>'T</span><span class=mtk14>></span><span class=mtk1>.FullName </span><span class=mtk14>|></span><span class=mtk1> printfn </span><span class=mtk10>"</span><span class=mtk14>%s</span><span class=mtk10>"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let inline</span><span class=mtk1> </span><span class=mtk5>doesWork</span><span class=mtk14>(</span><span class=mtk1>x</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>'T</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    typeof</span><span class=mtk14>&lt;</span><span class=mtk1>'T</span><span class=mtk14>></span><span class=mtk1>.FullName </span><span class=mtk14>|></span><span class=mtk1> printfn </span><span class=mtk10>"</span><span class=mtk14>%s</span><span class=mtk10>"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>doesWork </span><span class=mtk6>5</span></span></span></code></pre><h2 id=numeric-types>Numeric types<a href=#numeric-types aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>In Fable, we use F# numeric types, which are all translated to JS Number (64-bit floating type) at the exception of <code>int64</code>, <code>uint64</code>, <code>bigint</code> and <code>decimal</code>.<p>Fable numbers are very nearly compatible with .NET semantics, but translating into Javascript types has consequences:<ul><li>(non-standard) All floating point numbers are implemented as 64 bit (<code>double</code>). This makes <code>float32</code> numbers more accurate than expected.<li>(non-standard) Arithmetic integers of 32 bits or less are implemented with different truncation from that expected, as whole numbers embedded within <code>double</code>.<li>(OK) Conversions between types are correctly truncated.<li>(OK) Bitwise operations for 64 bit and 32 bit integers are correct and truncated to the appropriate number of bits.<li>(non-standard) Bitwise operations for 16 bit and 8 bit integers use the underlying JavaScript 32 bit bitwise semantics. Results are not truncated as expected, and shift operands are not masked to fit the data type.<li>(OK) Longs have a custom implementation which is identical in semantics to .NET and truncates in 64 bits, although it is slower.</ul><p>32 bit integers thus differ from .NET in two ways:<ul><li>Underlying 52 bit precision, without expected truncation to 32 bits on overflow. Truncation can be forced if needed by <code>>>> 0</code>.<li>On exceeding 52 bits absolute value floating point loses precision. So overflow will result in unexpected lower order 0 bits.</ul><p>The loss of precision can be seen in a single multiplication:<pre class="atom-one-light grvsc-container"data-index=4 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>((</span><span class=mtk6>1</span><span class=mtk1> </span><span class=mtk14>&#60&#60&lt;</span><span class=mtk1> </span><span class=mtk6>28</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>+</span><span class=mtk1> </span><span class=mtk6>1</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>*</span><span class=mtk1> </span><span class=mtk14>((</span><span class=mtk6>1</span><span class=mtk1> </span><span class=mtk14>&#60&#60&lt;</span><span class=mtk1> </span><span class=mtk6>28</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>+</span><span class=mtk1> </span><span class=mtk6>1</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>>>></span><span class=mtk1> </span><span class=mtk6>0</span></span></span></code></pre><p>The multiply product will have internal double representation rounded to <code>0x0100_0000_2000_0000</code>. When it is truncated to 32 bits by <code>>>> 0</code> the result will be <code>0x2000_0000</code> not the .NET exact lower order bits value of <code>0x2000_0001</code>.<p>The same problem can be seen where repeated arithmetic operations make the internal (non-truncated) value large. For example a linear congruence random number generator:<pre class="atom-one-light grvsc-container"data-index=5 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>rng</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>s</span><span class=mtk14>:</span><span class=mtk4>int32</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk6>10001</span><span class=mtk14>*</span><span class=mtk1>s </span><span class=mtk14>+</span><span class=mtk1> </span><span class=mtk6>12345</span></span></span></code></pre><p>The numbers generated by repeated application of this to its result will all be even after the 4th pseudo-random number, when <code>s</code> value exceeds 2^53:<pre class="atom-one-light grvsc-container"data-index=6 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>let rec</span><span class=mtk1> </span><span class=mtk5>randLst</span><span class=mtk1> n s </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>match</span><span class=mtk1> n </span><span class=mtk14>with</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>|</span><span class=mtk1> </span><span class=mtk6>0</span><span class=mtk1> </span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk14>[</span><span class=mtk1>s</span><span class=mtk14>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>|</span><span class=mtk1> n </span><span class=mtk14>-></span><span class=mtk1> s </span><span class=mtk14>::</span><span class=mtk1> randLst </span><span class=mtk14>(</span><span class=mtk1>n</span><span class=mtk6>-1</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>rng s</span><span class=mtk14>)</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>List.iter </span><span class=mtk14>(</span><span class=mtk1>printfn </span><span class=mtk10>"</span><span class=mtk14>%x</span><span class=mtk10>"</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>randLst </span><span class=mtk6>7</span><span class=mtk1> </span><span class=mtk6>1</span><span class=mtk14>)</span></span></span></code></pre><p>The resulting printed list of pseudo-random numbers does not work in Fable:<table><thead><tr><th align=right>Fable<th align=right>.NET<tbody><tr><td align=right>1<td align=right>1<tr><td align=right>574a<td align=right>574a<tr><td align=right>d524223<td align=right>d524223<tr><td align=right>6a89e98c<td align=right>6a89e98c<tr><td align=right>15bd0684<td align=right>15bd0685<tr><td align=right>3d8b8000<td align=right>3d8be20e<tr><td align=right>50000000<td align=right>65ba5527<tr><td align=right>0<td align=right>2458c8d0</table><h3 id=workarounds>Workarounds<a href=#workarounds aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h3><ul><li>When accurate low-order bit arithmetic is needed and overflow can result in numbers larger than 2^53 use <code>int64</code>, <code>uint64</code>, which use exact 64 bits, instead of <code>int32</code>, <code>uint32</code>.<li>Alternately, truncate all arithmetic with <code>>>> 0</code> or <code>>>> 0u</code> as appropriate before numbers can get larger than 2^53: <code>let rng (s:int32) = 10001*s + 12345 >>> 0</code></ul><h2 id=unsupported-attributes-and-types>Unsupported Attributes and Types<a href=#unsupported-attributes-and-types aria-hidden=true tabindex=-1><span class=anchor>#</span></a></h2><p>If your F# code contains attributes (or other types) that are not supported by Fable you will get a Compiler error similar to: <code>error FSHARP: The type 'DataContract' is not defined. (code 39)</code> for<pre class="atom-one-light grvsc-container"data-index=7 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>System.Runtime.Serialization</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60DataContract>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>Person</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk14>{</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk8>[&#60DataMember</span><span class=mtk14>(</span><span class=mtk8>IsRequired </span><span class=mtk14>=</span><span class=mtk8> </span><span class=mtk6>true</span><span class=mtk14>)</span><span class=mtk8>>]</span><span class=mtk1> FullName</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>string</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk8>[&#60DataMember</span><span class=mtk14>(</span><span class=mtk8>IsRequired </span><span class=mtk14>=</span><span class=mtk8> </span><span class=mtk6>true</span><span class=mtk14>)</span><span class=mtk8>>]</span><span class=mtk1> TimeOfBirth</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>DateTimeOffset</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>}</span></span></span></code></pre><p>If you just want the attribute (or types) to be ignored in Fable you can redefine it as an empty type:<pre class="atom-one-light grvsc-container"data-index=8 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>#if FABLE</span><span class=mtk14>_</span><span class=mtk1>COMPILER</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>namespace</span><span class=mtk9> System.Runtime.Serialization</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>System</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>DataContract</span><span class=mtk6>()</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk14>inherit</span><span class=mtk1> Attribute</span><span class=mtk6>()</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>DataMember</span><span class=mtk14>(</span><span class=mtk1>IsRequired</span><span class=mtk14>:</span><span class=mtk4> bool</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk14>inherit</span><span class=mtk1> Attribute</span><span class=mtk6>()</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>#endif</span></span></span></code></pre></div></div></section><div class="section bd-docs-pagination bd-pagination-links"><a class="button bd-fat-button is-primary is-light bd-pagination-prev" href="/docs/javascript/features.html"><i>â</i><span class="is-hidden-mobile"><em>JavaScript</em><strong>Features</strong></span></a><a class="button bd-fat-button is-primary is-light bd-pagination-next" href="/docs/typescript/build-and-run.html"><span class="is-hidden-mobile"><em>TypeScript</em><strong>Build and Run</strong></span><i>â</i></a></div></div></div></div></div><script async="" src="/resources/nacara-standard-layouts/scripts/menu.js"></script></body></html>